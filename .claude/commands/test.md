Necesito que ejecutes y corrijas todos los tests del proyecto usando el comando `npm run test`.

Requisitos:

1. Ejecuta los tests y analiza todos los fallos que encuentres
2. Revisa los ejemplos de tests existentes en las carpetas `tests/` o `__tests__/` para entender los patrones y mejores
   prácticas del proyecto
3. Corrige cada test fallido siguiendo el mismo estilo y estructura de los tests existentes
4. Asegúrate de:

- Usar los mismos frameworks y librerías de testing que el proyecto
- Mantener la misma estructura de archivos y nombres
- Seguir las convenciones de naming y organización
- Aplicar las mismas estrategias de mocking y fixtures
- Mantener el mismo nivel de cobertura y exhaustividad

5. Después de cada corrección, vuelve a ejecutar los tests para verificar que funcionan
6. Repite el proceso hasta que todos los tests pasen exitosamente

Muéstrame el progreso paso a paso y explica qué problemas encontraste y cómo los solucionaste.
